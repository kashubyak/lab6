# Лабораторна робота 6: Безпечна система управління обліковими записами

Цей проект реалізує безпечну систему автентифікації з використанням Flask.

## Функціонал

1.  **Реєстрація та Вхід**:
    - Парольна політика (мін. 8 символів, великі/малі літери, цифри, спецсимволи).
    - Хешування паролів.
    - CAPTCHA при реєстрації.
2.  **Активація акаунту**: Підтвердження через Email.
3.  **Безпека входу**:
    - Обмеження кількості невдалих спроб (блокування після 5 спроб).
    - Логування всіх спроб входу (успішних та невдалих).
4.  **Двохфакторна аутентифікація (2FA)**:
    - Використання TOTP (Google Authenticator).
    - Можливість увімкнення/вимкнення в профілі.
5.  **OAuth**: Вхід через Google.
6.  **Відновлення пароля**: Через Email з часовим токеном.

## Встановлення та Запуск

### 1. Встановлення залежностей

Створіть віртуальне середовище (рекомендовано) та встановіть пакети:

```bash
pip install -r requirements.txt
```

### 2. Налаштування змінних середовища

Для коректної роботи відправки пошти та входу через Google, вам потрібно встановити змінні середовища. Ви можете зробити це в терміналі перед запуску:

**MacOS / Linux:**

```bash
export EMAIL_USER="ваш_email@gmail.com"
export EMAIL_PASS="ваш_пароль_додатку_gmail"
export GOOGLE_OAUTH_CLIENT_ID="607554969368-pj5hbs1vlcdt7jv1a3mka2vq4chfen5v.apps.googleusercontent.com"
export GOOGLE_OAUTH_CLIENT_SECRET="ВАШ_GOOGLE_CLIENT_SECRET"
```

> **Примітка:** Для `EMAIL_PASS` використовуйте "Пароль додатку" (App Password) від Google, а не ваш звичайний пароль.
> **Примітка:** `GOOGLE_OAUTH_CLIENT_SECRET` ви повинні взяти з консолі розробника Google, де ви створили Client ID.

### 3. Запуск додатку

```bash
python app.py
```

Додаток буде доступний за адресою: `http://127.0.0.1:5000`

## Тестування функціоналу

1.  **Реєстрація**: Спробуйте зареєструвати нового користувача. Перевірте пошту на наявність посилання для активації.
2.  **Вхід**: Спробуйте увійти. Якщо акаунт не активовано, система не пустить.
3.  **Google Вхід**: Натисніть "Увійти через Google".
4.  **2FA**: Увійдіть, перейдіть у профіль, налаштуйте 2FA (відскануйте QR-код додатком Google Authenticator). Вийдіть і спробуйте увійти знову — система запитає код.
5.  **Забули пароль**: На сторінці входу натисніть "Забули пароль?", введіть email і перевірте пошту.
6.  **Логи**: Увійдіть (якщо ви перший користувач або маєте доступ) і перейдіть за адресою `/admin/logs` (посилання є в хедері після входу), щоб переглянути журнал спроб входу.

## Структура проекту

- `app.py`: Головний файл додатку з усією логікою.
- `templates/`: HTML-шаблони.
- `users.db`: База даних SQLite (створюється автоматично при першому запуску).
